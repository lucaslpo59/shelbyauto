<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RuinerAuto</title>
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="assets/css/paineluser.css">
    <link rel="stylesheet" href="assets/css/filter.css">
</head>


<body>
    <header class="">
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <img src="https://i.ibb.co/QyrTP0y/A-c-pia.png" alt="Logo Concession√°ria GTA RP" style="height: 50px;">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                    aria-controls="navbarResponsive" aria-expanded="false" aria-label="Alternar navega√ß√£o">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="homepage.html">HOMEPAGE</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="filter.html">NOSSO ESTOQUE</a>
                        </li>
                    </ul>
                </div>

                <!-- Menu do Usu√°rio -->
                <div class="user-menu" id="userMenu">
                    <div class="user-profile" onclick="toggleMenu()">
                        <img src="https://cdn.pixabay.com/photo/2018/04/18/18/56/user-3331256_1280.png" id="userAvatar"
                            alt="Avatar">
                        <span id="userName">Usu√°rio</span>
                        <i class="arrow-down"></i> <!-- √çcone de seta -->
                    </div>


                    <div class="dropdown-menu" id="dropdownMenu">
                        <ul>
                            <li><a href="profile.html"><i class="fas fa-user"></i> Meu Perfil</a></li>
                            <li><a href="settings.html"><i class="fas fa-cog"></i> Configura√ß√µes</a></li>
                            <li><a href="index.html" id="logout"><i class="fas fa-sign-out-alt"></i> Sair</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Link para login/registro -->
                <div id="loginRegister" style="display: none;">
                    <a href="index.html">Fazer Login / Registrar</a>
                </div>
            </div>
        </nav>
    </header>


    <div class="container products">

        <!-- Esta linha estava duplicada, ent√£o removi -->
        <div class="products-container" id="car-list"></div>

    </div> <!-- Fechamento correto da "container products" -->

    <!-- O script que gera os carros deve estar FORA da div principal -->
    <script>
        const carros = [
            {
                nome: "GM Kadett GSI",
                preco: "R$ 78.999,00",
                fipe: "R$ 69.900,00",
                km: "001259 KM",
                cambio: "Manual",
                placa: "ZTB-5745",

                vendido: true,  // false = üî¥ Carro foi vendido
                imagens: ["https://i.ibb.co/xKjPS2QN/image.png", "https://i.ibb.co/jZVqQB2f/image.png", "https://i.ibb.co/ZpNNrmLz/image.png"
                ],
                specs: [
                    "<strong>Pist√£o:</strong> Original",
                    "<strong>Biela:</strong> Original",
                    "<strong>Cabe√ßote:</strong> Original",
                    "<strong>Comando:</strong> Original",
                    "<strong>Radiador:</strong> Original",
                    "<strong>Nitro:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Turbo:</strong> <span style='color:green;'>50/63</span>",
                    "<strong>Radiador de √ìleo:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Intercooler:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>C√¢mbio:</strong> <span style='color:yellow;'>Alongado</span>",
                    "<strong>Suspens√£o:</strong> Original",
                    "<strong>Freios:</strong> Original",
                    "<strong>Downpipe:</strong> <span style='color:lightgreen;'>Alto Fluxo INOX</span>",
                    "<strong>Coletor ADM:</strong> Original",
                    "<strong>Moral:</strong> <span style='color:green;'>18/200</span>"
                ],
                documentation: {
                    roda: "Sim",
                    turbo: "Sim",
                    cor: "Branco",
                    legalizado: true
                }
            },


            {
                nome: "GM Chevette DL ",
                preco: "R$ 36.799,00",
                fipe: "R$ 20.000,00",
                km: "002087 KM",
                cambio: "Manual",
                placa: "YPH-0030",

                vendido: true,  // false = üî¥ Carro foi vendido
                imagens: ["https://i.ibb.co/BSjNSdw/image.png","https://i.ibb.co/gFLJjppw/image.png","https://i.ibb.co/xSsdsnQT/image.png","https://i.ibb.co/MkJJ5Nmc/image.png"
                ],
                specs: [
                    "<strong>Pist√£o:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Biela:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Cabe√ßote:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Comando:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Radiador:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Nitro:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Turbo:</strong> <span style='color:green;'>50/48</span>",
                    "<strong>Radiador de √ìleo:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Intercooler:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>C√¢mbio:</strong> <span style='color:lightgreen;'>Alongado</span>",
                    "<strong>Suspens√£o:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Freios:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Downpipe:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Coletor ADM:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Moral:</strong> <span style='color:green;'>118/200</span>"
                ],
                documentation: {
                    roda: "N√£o",
                    turbo: "N√£o",
                    cor: "Prata",
                    legalizado: false
                }
            },


            {
                nome: "GM Chevette DL ",
                preco: "R$ 36.799,00",
                fipe: "R$ 20.000,00",
                km: "002087 KM",
                cambio: "Manual",
                placa: "TZQ-6608",

                vendido: true,  // false = üî¥ Carro foi vendido
                imagens: ["https://i.ibb.co/W4z89DfP/image.png", "https://i.ibb.co/v6ctDK0V/image.png", "https://i.ibb.co/MDxyVXzr/image.png"
                ],
                specs: [
                    "<strong>Pist√£o:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Biela:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Cabe√ßote:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Comando:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Radiador:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Nitro:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Turbo:</strong> <span style='color:green;'>50/48</span>",
                    "<strong>Radiador de √ìleo:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Intercooler:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>C√¢mbio:</strong> <span style='color:lightgreen;'>Alongado</span>",
                    "<strong>Suspens√£o:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Freios:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Downpipe:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Coletor ADM:</strong> <span style='color:yellow;'>Original</span>",
                    "<strong>Moral:</strong> <span style='color:green;'>25/200</span>"
                ],
                documentation: {
                    roda: "N√£o",
                    turbo: "N√£o",
                    cor: "Vermelho",
                    legalizado: false
                }
            },
            {
                nome: "GOL G4 RALLY",
                preco: "R$ 15.750,00",
                fipe: "R$ 21.00,00",
                km: "000410 KM",
                cambio: "Manual",
                placa: "XJR-0532",

                vendido: false,  // false = üî¥ Carro foi vendido
                imagens: ["https://i.ibb.co/vCC5hZvY/image.png",
                    "https://i.ibb.co/zV3zqjnJ/image.png",
                    "https://i.ibb.co/Z6Mp9nd3/image.png"
                ],
                specs: [
                    "<strong>Pist√£o:</strong> Original",
                    "<strong>Biela:</strong> Original",
                    "<strong>Cabe√ßote:</strong> Original",
                    "<strong>Comando:</strong> Original",
                    "<strong>Radiador:</strong> Original",
                    "<strong>Nitro:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Turbo:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Radiador de √ìleo:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>Intercooler:</strong> <span style='color:red;'>N√£o</span>",
                    "<strong>C√¢mbio:</strong> Original",
                    "<strong>Suspens√£o:</strong> Original",
                    "<strong>Freios:</strong> Original",
                    "<strong>Coletor ESC:</strong> Original",
                    "<strong>Coletor ADM:</strong> Original",
                    "<strong>Moral:</strong> <span style='color:green;'>0/200</span>"
                ],
                documentation: {
                    roda: "Original",
                    turbo: "N√£o",
                    cor: "Preto",
                    legalizado: true
                }
            },
        ];

        carros.forEach((carro, index) => {
            document.write(`
<div class="product-item">
    <div class="product-content">
        <div class="carousel" id="carousel-${index}">
            <button class="carousel-prev" onclick="prevImage(${index})">&#10094;</button>
            <div class="carousel-images">
                ${carro.imagens.map((img, i) => `<img src="${img}" class="${i === 0 ? 'active' : ''}" alt="${carro.nome}">`).join('')}
            </div>
            <button class="carousel-next" onclick="nextImage(${index})">&#10095;</button>
        </div>
        <div class="product-info">
            <hr>
            <h4>${carro.nome}</h4>
            <h6>${carro.preco}</h6>
            <p class="${carro.vendido ? 'legalizado' : 'nao-legalizado'}">
                ${carro.vendido ? 'DISPONIVEL' : 'N√ÉO DISPONIVEL'}
            </p>
            <hr>
            <p>FIPE: ${carro.fipe}</p>
            <p>${carro.km} | ${carro.placa} | ${carro.cambio}</p>

            <button class="form-btn" data-index="${index}">FAZER UMA PROPOSTA</button>
        </div>
        <div class="specifications">
            <h5>Especifica√ß√µes</h5>
            <ul>
                ${carro.specs.map(spec => `
                <li>${spec}</li>`).join('')}
            </ul>
        </div>
        <div class="documentation">
            <h5>Documenta√ß√£o</h5>
            <p><strong>Roda:</strong> ${carro.documentation.roda}</p>
            <p><strong>Turbo:</strong> ${carro.documentation.turbo}</p>
            <p><strong>Cor:</strong> ${carro.documentation.cor}</p>
            <p class="${carro.documentation.legalizado ? 'legalizado' : 'nao-legalizado'}">
                ${carro.documentation.legalizado ? 'Legalizado' : 'N√£o Legalizado'}
            </p>
        </div>
    </div>  
</div>
`);
        });
    </script>
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="inner-content">
                        <p>COPYRIGHT ¬© 2025 RUINER AUTO ( BRASILIA RP ) SERVER 2 - DESENVOLVIDO BY
                            <a href="#">Ruiner Enterprises L.L.C</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.querySelectorAll(".upload-input").forEach(input => {
            input.addEventListener("change", function () {
                let fileName = this.files.length > 0 ? this.files[0].name : "Nenhum arquivo escolhido";
                document.getElementById(`file-name-${this.id.split("-")[1]}`).textContent = fileName;
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".form-btn").forEach(button => {
                button.addEventListener("click", function () {
                    let index = this.getAttribute("data-index");
                    openForm(index);
                });
            });

            // üîπ Esconde todos os formul√°rios no carregamento
            document.querySelectorAll(".form-popup").forEach(form => {
                form.style.display = "none";
            });
        });

        function openForm(index) {
            let form = document.getElementById(`form-${index}`);

            if (!form) {
                console.error(`‚ùå Erro: Formul√°rio form-${index} n√£o encontrado.`);
                return;
            }

            form.style.display = "flex";
            setTimeout(() => {
                form.classList.add("show"); // üîπ Adiciona a anima√ß√£o ao abrir
            }, 10);

            let productItem = document.querySelectorAll(".product-item")[index];

            if (!productItem) {
                console.error("‚ùå Erro: O elemento .product-item n√£o foi encontrado.");
                return;
            }

            let carRect = productItem.getBoundingClientRect();
            form.style.left = `${carRect.right + 15}px`;
            form.style.top = `${carRect.top}px`;

            // üîπ Pegando informa√ß√µes completas do carro
            if (carros[index]) {
                let carro = carros[index];

                // üõë Atualiza os campos ocultos no formul√°rio
                document.getElementById(`carroNome-${index}`).value = carro.nome;
                document.getElementById(`carroPreco-${index}`).value = carro.preco;
                document.getElementById(`carroFipe-${index}`).value = carro.fipe;
                document.getElementById(`carroKm-${index}`).value = carro.km;
                document.getElementById(`carroCambio-${index}`).value = carro.cambio;
                document.getElementById(`carroPlaca-${index}`).value = carro.placa;
                let campoImagem = document.getElementById(`carroImagem-${index}`);
                if (campoImagem) {
                    campoImagem.value = carro.imagem || "";
                }
            } else {
                console.warn(`‚ö†Ô∏è Nenhum carro encontrado no √≠ndice ${index}`);
            }

            // üîπ Adicionando evento ao bot√£o de envio do formul√°rio
            let submitButton = form.querySelector(".popup-btn.submit");
            if (submitButton) {
                submitButton.onclick = function () {
                    enviarFormulario(index);
                };
            }
        }

        // üîπ Fun√ß√£o para converter imagem em Base64
        function converterImagemBase64(file) {
            return new Promise((resolve, reject) => {
                let reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        // üîπ Fun√ß√£o para fechar o formul√°rio e limpar os campos
        function closeForm(index) {
            let form = document.getElementById(`form-${index}`);
            if (form) {
                form.classList.remove("show"); // üîπ Remove anima√ß√£o de abertura
                setTimeout(() => {
                    form.style.display = "none";
                }, 300);

                // üîπ Limpa os campos do formul√°rio, incluindo inputs e textarea
                form.querySelectorAll("input, textarea").forEach(input => {
                    if (input.type !== "hidden") { // Mant√©m os campos ocultos com informa√ß√µes do carro
                        input.value = "";
                    }
                });
            }
        }

        // üîπ Fun√ß√£o para enviar o formul√°rio
        function enviarFormulario(index) {
            let form = document.getElementById(`form-${index}`);

            if (!form) {
                console.error(`‚ùå Erro: Formul√°rio form-${index} n√£o encontrado.`);
                return;
            }

            // üîπ Simula envio de formul√°rio (aqui voc√™ pode adicionar requisi√ß√£o para backend ou Discord Webhook)
            console.log("‚úÖ Formul√°rio enviado com sucesso!");

            // üîπ Fecha e limpa o formul√°rio ap√≥s o envio
            closeForm(index);
        }


        // Estilos CSS corrigidos

    </script>

    <script>

        function enviarFormulario(index) {
            let nomeCarro = document.getElementById(`carroNome-${index}`).value;
            let carroPreco = document.getElementById(`carroPreco-${index}`).value;
            let carroFipe = document.getElementById(`carroFipe-${index}`).value;
            let carroKm = document.getElementById(`carroKm-${index}`).value;
            let carroCambio = document.getElementById(`carroCambio-${index}`).value;
            let carroPlaca = document.getElementById(`carroPlaca-${index}`).value;
            let nome = document.getElementById(`nome-${index}`).value;
            let discord = document.getElementById(`discord-${index}`).value;
            let celular = document.getElementById(`celular-${index}`).value;
            let comentario = document.getElementById(`comentario-${index}`).value || "Nenhum coment√°rio";
            let fotoInput = document.getElementById(`fotoCarro-${index}`);
            let foto = fotoInput && fotoInput.files.length > 0 ? fotoInput.files[0] : null;

            if (!nome || !discord || !celular) {
                alert("Por favor, preencha todos os campos obrigat√≥rios.");
                return;
            }

            function enviarParaDiscord(fotoURL = null) {
                let mensagem = {
                    username: "Novo Formul√°rio",
                    avatar_url: "https://img.freepik.com/psd-gratuitas/icone-do-whatsapp-isolado-ilustracao-de-renderizacao-3d_47987-9785.jpg",
                    content: `üì© **SAQ > ( Entrar Em Contato )**\n\n
### üîπ **Informa√ß√µes do Ve√≠culo:**\n
üöó **Carro:** \`${nomeCarro}\`\n
üí∞ **Pre√ßo:** \`${carroPreco}\`\n
üìä **FIPE:** \`${carroFipe}\`\n
üõ£Ô∏è **KM:** \`${carroKm}\`\n
‚öô **C√¢mbio:** \`${carroCambio}\`\n
üî¢ **Placa:** \`${carroPlaca}\`\n

### üîπ **Dados do Interessado:**\n
üë§ **Nome:** \`${nome}\`\n
üéß **Discord:** \`${discord}\`\n
üì± **Celular In-Game:** \`${celular}\`\n
üí¨ **Coment√°rio:** \`${comentario}\`\n
${fotoURL ? `üñºÔ∏è **Foto do Ve√≠culo:** [Clique para ver](${fotoURL})\n` : ""}
`
                };

                fetch("https://discordapp.com/api/webhooks/1343741774644117534/zoYLMvqda0hJRJNjDtBzE_3DNN9-EY651LjHIdpNSCygGjHE-Xjxln0uxjBSIbq8RiiZ", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(mensagem)
                }).then(response => {
                    if (response.ok) {
                        alert("‚úÖ Formul√°rio enviado com sucesso!");
                        closeForm(index); // Fecha o formul√°rio ap√≥s envio
                    } else {
                        alert("‚ùå Erro ao enviar formul√°rio.");
                    }
                }).catch(error => {
                    alert("‚ùå Erro de conex√£o: " + error.message);
                });
            }

            // üîπ Se houver imagem, faz upload antes de enviar
            if (foto) {
                let formData = new FormData();
                formData.append("image", foto);

                fetch("https://api.imgbb.com/1/upload?key=a85bd55edbbb971f0b7d546e0830327b", {
                    method: "POST",
                    body: formData
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            enviarParaDiscord(data.data.url); // Envia para o Discord com o link da imagem
                        } else {
                            console.error("Erro ao enviar imagem.");
                            enviarParaDiscord(null); // Envia sem imagem
                        }
                    })
                    .catch(error => {
                        console.error("Erro ao enviar imagem:", error);
                        enviarParaDiscord(null); // Envia sem imagem
                    });
            } else {
                enviarParaDiscord(null); // Se n√£o houver imagem, apenas envia o formul√°rio
            }
        }
    </script>

    <script>
        function toggleMenu() {
            let menu = document.getElementById("dropdownMenu");
            menu.style.display = (menu.style.display === "block") ? "none" : "block";
        }

        // Fecha o menu se o usu√°rio clicar fora dele
        document.addEventListener("click", function (event) {
            let menu = document.getElementById("dropdownMenu");
            let profile = document.querySelector(".user-profile");

            if (!profile.contains(event.target) && !menu.contains(event.target)) {
                menu.style.display = "none";
            }
        });


        function nextImage(index) {
            const carouselImages = document.getElementById(`carousel-${index}`).querySelectorAll('.carousel-images img');
            const activeIndex = Array.from(carouselImages).findIndex(img => img.classList.contains('active'));
            const nextIndex = (activeIndex + 1) % carouselImages.length;

            carouselImages[activeIndex].classList.remove('active');
            carouselImages[nextIndex].classList.add('active');
        }

    </script>

    <!-- üîπ Importando o Firebase e Script Global -->
    <!-- üîπ Script para abrir/fechar o menu do usu√°rio -->
    <script>
        function toggleMenu() {
            let menu = document.getElementById("dropdownMenu");
            menu.style.display = (menu.style.display === "block") ? "none" : "block";
        }

        // Fecha o menu se o usu√°rio clicar fora dele
        document.addEventListener("click", function (event) {
            let menu = document.getElementById("dropdownMenu");
            let profile = document.querySelector(".user-profile");

            if (!profile.contains(event.target) && !menu.contains(event.target)) {
                menu.style.display = "none";
            }
        });
    </script>


    <script type="module" src="assets/js/filter.js"></script>
</body>

</html>